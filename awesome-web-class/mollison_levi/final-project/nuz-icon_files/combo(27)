YUI.add("hermes-template-search-advanced-panel",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function d(e,t){return"fluid-centered"}function v(e,t){return"group-centered-content"}function m(e,t){return' checked="checked"'}function g(e,t){return' disabled="disabled"'}function y(e,t){var r="",i,s,o;r+='\n				<div class="swatch swatch-',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+'" title="',o={hash:{intlName:e.nameKey},data:t},r+=l((i=n.intlMessage||e.intlMessage,i?i.call(e,o):c.call(e,"intlMessage",o)))+'">\n					<input title="',o={hash:{intlName:e.nameKey},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,o):c.call(e,"intlHTMLMessage",o)))+'" type="checkbox" data-v="',(s=n.v)?s=s.call(e,{hash:{},data:t}):(s=e.v,s=typeof s===f?s.apply(e):s),r+=l(s)+'" value="',(s=n["int"])?s=s.call(e,{hash:{},data:t}):(s=e["int"],s=typeof s===f?s.apply(e):s),r+=l(s)+'" ',s=n.unless.call(e,e.noSwatchColor,{hash:{},inverse:h.noop,fn:h.program(10,b,t),data:t});if(s||s===0)r+=s;r+=' class="color" id="color-',(s=n.code)?s=s.call(e,{hash:{},data:t}):(s=e.code,s=typeof s===f?s.apply(e):s),r+=l(s)+'"  name="color-',(s=n.code)?s=s.call(e,{hash:{},data:t}):(s=e.code,s=typeof s===f?s.apply(e):s),r+=l(s)+'"',s=n["if"].call(e,e.selected,{hash:{},inverse:h.noop,fn:h.program(5,m,t),data:t});if(s||s===0)r+=s;s=n["if"].call(e,e.disabled,{hash:{},inverse:h.noop,fn:h.program(7,g,t),data:t});if(s||s===0)r+=s;r+='>\n					<label for="color-',(s=n.code)?s=s.call(e,{hash:{},data:t}):(s=e.code,s=typeof s===f?s.apply(e):s),r+=l(s)+'" ',s=n.unless.call(e,e.noSwatchColor,{hash:{},inverse:h.noop,fn:h.program(10,b,t),data:t});if(s||s===0)r+=s;return r+="></label>\n				</div>\n			",r}function b(e,t){var r="",i;return r+='style="background-color: #',(i=n.code)?i=i.call(e,{hash:{},data:t}):(i=e.code,i=typeof i===f?i.apply(e):i),r+=l(i)+"; border-color: #",(i=n.checkColor)?i=i.call(e,{hash:{},data:t}):(i=e.checkColor,i=typeof i===f?i.apply(e):i),r+=l(i)+'"',r}function w(e,t){var r="",i;return r+='value="',(i=n.startDate)?i=i.call(e,{hash:{},data:t}):(i=e.startDate,i=typeof i===f?i.apply(e):i),r+=l(i)+'" ',r}function E(e,t){var r="",i;return r+='value="',(i=n.endDate)?i=i.call(e,{hash:{},data:t}):(i=e.endDate,i=typeof i===f?i.apply(e):i),r+=l(i)+'" ',r}function S(e,t){return"checked"}function x(e,t){return'checked="checked"'}function T(e,t){return'\n	<div class="filter-bar-border"></div>\n	<div class="filter-bar fluid-centered">\n	'}function N(e,t){return'\n	<div class="filter-bar group-centered-content">\n	'}function C(e,t){var r="",i;r+='\n				<li><a href="#" data-value="',(i=n.value)?i=i.call(e,{hash:{},data:t}):(i=e.value,i=typeof i===f?i.apply(e):i),r+=l(i)+'" class="search-option',i=n["if"].call(e,e.selected,{hash:{},inverse:h.noop,fn:h.program(25,k,t),data:t});if(i||i===0)r+=i;return r+='">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+"</a></li>\n			",r}function k(e,t){return" selected"}function L(e,t){var r="",i;return r+='\n			<li><a class="search-license menu-anchor" href="#">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+"<span></span>\n			",r}function A(e,t){var r="",i;return r+='\n			<li><a class="safesearch menu-anchor" href="#">',(i=n.title)?i=i.call(e,{hash:{},data:t}):(i=e.title,i=typeof i===f?i.apply(e):i),r+=l(i)+"<span></span></a></li>\n			",r}function O(e,t){var r="",i,s;return r+='<li class="tools"><a href=',(i=n.resetUrl)?i=i.call(e,{hash:{},data:t}):(i=e.resetUrl,i=typeof i===f?i.apply(e):i),r+=l(i)+">",s={hash:{intlName:"search.RESET"},data:t},r+=l((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):c.call(e,"intlHTMLMessage",s)))+"</a></li>",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u,a,f="function",l=this.escapeExpression,c=n.helperMissing,h=this,p=n.blockHelperMissing;s+='<form action="/search">\n	<div class="advanced-panel ',o=n["if"].call(t,t.globalNavRestyleFlipped,{hash:{},inverse:h.program(3,v,i),fn:h.program(1,d,i),data:i});if(o||o===0)s+=o;s+='">\n\n		<div class="section-orientation panel-section">\n			<h5>',a={hash:{intlName:"search.ORIENTATION"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h5>\n			<div class="col">\n				<div class="radio" title="',a={hash:{intlName:"search.PORTRAIT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="checkbox" id="portrait" class="orientation" name="portrait"',u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.portrait),o==null||o===!1?o:o.checked),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.portrait),o==null||o===!1?o:o.disabled),{hash:{},inverse:h.noop,fn:h.program(7,g,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="portrait">\n						<div class="square"></div>\n						<span>',a={hash:{intlName:"search.PORTRAIT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName:"search.SQUARE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="checkbox" id="square" class="orientation" name="square"',u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.square),o==null||o===!1?o:o.checked),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.square),o==null||o===!1?o:o.disabled),{hash:{},inverse:h.noop,fn:h.program(7,g,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="square">\n						<div class="square"></div>\n						<span>',a={hash:{intlName:"search.SQUARE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName
:"search.LANDSCAPE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="checkbox" id="landscape" class="orientation" name="landscape"',u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.landscape),o==null||o===!1?o:o.checked),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.landscape),o==null||o===!1?o:o.disabled),{hash:{},inverse:h.noop,fn:h.program(7,g,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="landscape">\n						<div class="square"></div>\n						<span>',a={hash:{intlName:"search.LANDSCAPE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName:"search.PANORAMA"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="checkbox" id="panorama" class="orientation" name="panorama"',u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.panorama),o==null||o===!1?o:o.checked),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=(o=t.orientation,o==null||o===!1?o:o.panorama),o==null||o===!1?o:o.disabled),{hash:{},inverse:h.noop,fn:h.program(7,g,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="panorama">\n						<div class="square"></div>\n						<span>',a={hash:{intlName:"search.PANORAMA"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n					</label>\n				</div>\n			</div>\n		</div>\n\n		<div class="section-size panel-section">\n			<h5>',a={hash:{intlName:"search.MINIMUM_SIZE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h5>\n			<div class="col">\n				<div class="radio" title="',a={hash:{intlName:"search.ALL_SIZES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="radio" value="all" id="photo-size-all" class="sizes" name="sizes"',u=n["if"].call(t,(o=t.sizes,o==null||o===!1?o:o.all),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="photo-size-all">\n						<div></div>\n						<span>',a={hash:{intlName:"search.ALL_SIZES"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' <small></small></span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName:"search.MEDIUM"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="radio" value="medium" id="photo-size-medium" class="sizes" name="sizes"',u=n["if"].call(t,(o=t.sizes,o==null||o===!1?o:o.medium),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="photo-size-medium">\n						<div></div>\n						<span>',a={hash:{intlName:"search.MEDIUM"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+' <small>(640)</small></span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName:"search.LARGE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="radio" value="large" id="photo-size-large" class="sizes" name="sizes"',u=n["if"].call(t,(o=t.sizes,o==null||o===!1?o:o.large),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;s+='>\n					<label for="photo-size-large">\n						<div></div>\n						<span>',a={hash:{intlName:"search.LARGE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+" <small>(1024)</small></span>\n					</label>\n				</div>\n"+'\n 			</div>\n		</div>\n\n		<div class="section-colors panel-section">\n			<h5>',a={hash:{intlName:"search.COLOR"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h5>\n			<div class="swatches">\n			',u=n.each.call(t,t.colors,{hash:{},inverse:h.noop,fn:h.program(9,y,i),data:i});if(u||u===0)s+=u;s+='\n			</div>\n		</div>\n\n		<div class="section-date panel-section">\n			<h5>',a={hash:{intlName:"search.DATE"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h5>\n			<p>\n				<label for="datefrom">',a={hash:{intlName:"search.FROM"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</label>\n				<input class="datetime" id="datefrom" name="datefrom" type="text" ',u=n["if"].call(t,t.startDate,{hash:{},inverse:h.noop,fn:h.program(12,w,i),data:i});if(u||u===0)s+=u;s+='placeholder="',a={hash:{intlName:"pikaday.DATE_FORMAT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n			</p>\n			<p>\n				<label for="dateto">',a={hash:{intlName:"search.TO"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</label>\n				<input class="datetime end" id="dateto" name="dateto" type="text" ',u=n["if"].call(t,t.endDate,{hash:{},inverse:h.noop,fn:h.program(14,E,i),data:i});if(u||u===0)s+=u;s+='placeholder="',a={hash:{intlName:"pikaday.DATE_FORMAT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n			</p>\n			<div class="date-mode-options">\n				<div class="radio" title="',a={hash:{intlName:"search.DATE_TAKEN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="radio" value="taken_date" id="taken" class="date-mode" ',u=n["if"].call(t,(o=t.dateParams,o==null||o===!1?o:o.taken),{hash:{},inverse:h.noop,fn:h.program(16,S,i),data:i});if(u||u===0)s+=u;s+=' name="date-mode">\n					<label for="taken">\n						<div></div>\n						<span>',a={hash:{intlName:"search.DATE_TAKEN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName:"search.DATE_POSTED"},data:i},s+=l((o=n.intlMessage||
t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="radio" value="upload_date" ',u=n["if"].call(t,(o=t.dateParams,o==null||o===!1?o:o.uploaded),{hash:{},inverse:h.noop,fn:h.program(16,S,i),data:i});if(u||u===0)s+=u;s+=' id="uploaded" class="uploaded" name="date-mode">\n					<label for="uploaded">\n						<div></div>\n						<span>',a={hash:{intlName:"search.DATE_POSTED"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n					</label>\n				</div>\n			</div>\n		</div>\n\n		<div class="section-content panel-section">\n			<h5>',a={hash:{intlName:"search.CONTENT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h5>\n			<div class="radio" title="',a={hash:{intlName:"search.PHOTOS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n				<input type="checkbox" id="photos" class="content-type" name="photos"',u=n["if"].call(t,(o=(o=t.media,o==null||o===!1?o:o.photos),o==null||o===!1?o:o.checked),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=(o=t.media,o==null||o===!1?o:o.photos),o==null||o===!1?o:o.disabled),{hash:{},inverse:h.noop,fn:h.program(7,g,i),data:i});if(u||u===0)s+=u;s+='>\n				<label for="photos">\n					<div class="square"></div>\n					<span>',a={hash:{intlName:"search.PHOTOS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n				</label>\n			</div>\n			<div class="radio" title="',a={hash:{intlName:"search.VIDEOS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n				<input type="checkbox" class="media content-type" id="videos" name="videos"',u=n["if"].call(t,(o=(o=t.media,o==null||o===!1?o:o.videos),o==null||o===!1?o:o.checked),{hash:{},inverse:h.noop,fn:h.program(18,x,i),data:i});if(u||u===0)s+=u;u=n["if"].call(t,(o=(o=t.media,o==null||o===!1?o:o.videos),o==null||o===!1?o:o.disabled),{hash:{},inverse:h.noop,fn:h.program(7,g,i),data:i});if(u||u===0)s+=u;s+='>\n				<label for="videos">\n					<div class="square"></div>\n					<span>',a={hash:{intlName:"search.VIDEOS"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</span>\n				</label>\n			</div>\n		</div>\n\n		<div class="section-search-in panel-section">\n			<h5>',a={hash:{intlName:"search.SEARCH_IN"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'</h5>\n			<div class="col">\n				<div class="radio" title="',a={hash:{intlName:"search.FULL_TEXT"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input type="radio" class="searchin" ',u=n["if"].call(t,(o=t.tagMode,o==null||o===!1?o:o.text),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;s+=' id="full-text" name="tagmode">\n					<label for="full-text">\n						<div></div>\n						<span>',a={hash:{intlName:"search.FULL_TEXT"},data:i},s+=l((o=n.intlHTMLMessage||t.intlHTMLMessage,o?o.call(t,a):c.call(t,"intlHTMLMessage",a)))+'</span>\n					</label>\n				</div>\n				<div class="radio" title="',a={hash:{intlName:"search.TAGS_ONLY"},data:i},s+=l((o=n.intlMessage||t.intlMessage,o?o.call(t,a):c.call(t,"intlMessage",a)))+'">\n					<input ',u=n["if"].call(t,(o=t.tagMode,o==null||o===!1?o:o.tags),{hash:{},inverse:h.noop,fn:h.program(5,m,i),data:i});if(u||u===0)s+=u;s+=' type="radio" id="tags-only" class="searchin" name="tagmode">\n					<label for="tags-only">\n						<div></div>\n						<span>',a={hash:{intlName:"search.TAGS_ONLY"},data:i},s+=l((o=n.intlHTMLMessage||t.intlHTMLMessage,o?o.call(t,a):c.call(t,"intlHTMLMessage",a)))+"</span>\n					</label>\n				</div>\n			</div>\n		</div>\n	</div>\n\n	",u=n["if"].call(t,t.globalNavRestyleFlipped,{hash:{},inverse:h.program(22,N,i),fn:h.program(20,T,i),data:i});if(u||u===0)s+=u;s+='\n		<div class="safesearch-menu-hidden hidden">\n			<ul data-label-class="safesearch" data-param="safe_search" class="search-menu">\n			',u=n.each.call(t,t.safeSearch,{hash:{},inverse:h.noop,fn:h.program(24,C,i),data:i});if(u||u===0)s+=u;s+='\n			</ul>\n		</div>\n\n		<div class="license-menu-hidden hidden">\n			<ul data-label-class="search-license" data-param="license" class="search-menu">\n			',u=n.each.call(t,t.licenses,{hash:{},inverse:h.noop,fn:h.program(24,C,i),data:i});if(u||u===0)s+=u;s+='\n			</ul>\n		</div>\n\n		<ul class="filter-me">\n			',a={hash:{},inverse:h.noop,fn:h.program(27,L,i),data:i},(u=n.selectedLicense)?u=u.call(t,a):(u=t.selectedLicense,u=typeof u===f?u.apply(t):u),n.selectedLicense||(u=p.call(t,u,a));if(u||u===0)s+=u;s+="\n			",a={hash:{},inverse:h.noop,fn:h.program(29,A,i),data:i},(u=n.selectedSearch)?u=u.call(t,a):(u=t.selectedSearch,u=typeof u===f?u.apply(t):u),n.selectedSearch||(u=p.call(t,u,a));if(u||u===0)s+=u;s+="\n			</a></li>\n			",u=n["if"].call(t,t.resetUrl,{hash:{},inverse:h.noop,fn:h.program(31,O,i),data:i});if(u||u===0)s+=u;return s+="\n		</ul>\n	</div>\n</form>\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-advanced-panel",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-advanced-panel-view",function(e){var t="any",n="640",r="1024",i=5,s=[{nameKey:"search.RED",code:"ff2000","int":"0"},{nameKey:"search.DARK_ORANGE",code:"a24615","int":"1"},{nameKey:"search.ORANGE",code:"ff7c00","int":"2"},{nameKey:"search.PALE_PINK",code:"ff9f9c","int":"b"},{nameKey:"search.LEMON_YELLOW",code:"fffa00","int":"4"},{nameKey:"search.SCHOOL_BUS_YELLOW",code:"ffcf00","int":"3"},{nameKey:"search.GREEN",code:"90e200","int":"5"},{nameKey:"search.LIME_GREEN",code:"00ab00","int":"6"},{nameKey:"search.CYAN",code:"00b2d4","int":"7"},{nameKey:"search.BLUE",code:"0062c6","int":"8"},{nameKey:"search.VIOLET",code:"8c20ba","int":"9"},{nameKey:"search.PINK",code:"f52394","int":"a"},{nameKey:"search.WHITE",code:"ffffff","int":"c"},{nameKey:"search.GRAY",code:"7c7c7c","int":"d"},{nameKey:"search.BLACK",code:"000000","int":"e"},{nameKey:"search.MONOCHROME",code:"bw",noSwatchColor:!0,"int":"bw"}],o={};s.forEach(function(e,t){var n,r,i,s;o[e.int]=t,n=parseInt(e.code.substr(0,2),16),r=parseInt(e.code.substr(2,2),16),i=parseInt(e.code.substr(4,2),16),s=(n+r+i)/3/255,s>.6?e.checkColor="959a9d":e.checkColor="ffffff",e.v=s}),e.FlickrView.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,bwMode:!1,dateMode:"taken_date",updateTimeout:!1,maxColors:5,initializer:function(n){return this.get("container").get("innerHTML")===""&&this.setContainerHTML(""),this.dateIntl={previousMonth:this.intlMessage({intlName:"pikaday.PREVIOUS_MONTH"}),nextMonth:this.intlMessage({intlName:"pikaday.NEXT_MONTH"})},this.dateIntl.weekdays=[this.intlMessage({intlName:"pikaday.SUNDAY"}),this.intlMessage({intlName:"pikaday.MONDAY"}),this.intlMessage({intlName:"pikaday.TUESDAY"}),this.intlMessage({intlName:"pikaday.WEDNESDAY"}),this.intlMessage({intlName:"pikaday.THURSDAY"}),this.intlMessage({intlName:"pikaday.FRIDAY"}),this.intlMessage({intlName:"pikaday.SATURDAY"})],this.dateIntl.weekdaysShort=[this.intlMessage({intlName:"pikaday.SUNDAY_SHORT"}),this.intlMessage({intlName:"pikaday.MONDAY_SHORT"}),this.intlMessage({intlName:"pikaday.TUESDAY_SHORT"}),this.intlMessage({intlName:"pikaday.WEDNESDAY_SHORT"}),this.intlMessage({intlName:"pikaday.THURSDAY_SHORT"}),this.intlMessage({intlName:"pikaday.FRIDAY_SHORT"}),this.intlMessage({intlName:"pikaday.SATURDAY_SHORT"})],this.dateIntl.months=[this.intlMessage({intlName:"pikaday.JANUARY"}),this.intlMessage({intlName:"pikaday.FEBRUARY"}),this.intlMessage({intlName:"pikaday.MARCH"}),this.intlMessage({intlName:"pikaday.APRIL"}),this.intlMessage({intlName:"pikaday.MAY"}),this.intlMessage({intlName:"pikaday.JUNE"}),this.intlMessage({intlName:"pikaday.JULY"}),this.intlMessage({intlName:"pikaday.AUGUST"}),this.intlMessage({intlName:"pikaday.SEPTEMBER"}),this.intlMessage({intlName:"pikaday.OCTOBER"}),this.intlMessage({intlName:"pikaday.NOVEMBER"}),this.intlMessage({intlName:"pikaday.DECEMBER"})],this.searchUrl=new e.SearchUrl(n.modelParams.apiParams,this.appContext),this.licenses=[{value:t,title:this.intlMessage({intlName:"search.ANY_LICENSE"})},{value:"2,3,4,5,6,9",title:this.intlMessage({intlName:"search.ALL_CC"})},{value:"4,5,6,9,10",title:this.intlMessage({intlName:"search.COMMERCIAL_USE"})},{value:"1,2,9,10",title:this.intlMessage({intlName:"search.MODS_ALLOWED"})},{value:"4,5,9,10",title:this.intlMessage({intlName:"search.COMMERCIAL_USE_MODS"})},{value:"7,9,10",title:this.intlMessage({intlName:"search.NO_RESTRICTIONS"})},{value:"8",title:this.intlMessage({intlName:"search.US_GOVT"})}],this.defaultLicense=this.licenses[0],this.safeSearch=[{value:"1",title:this.intlMessage({intlName:"search.SAFESEARCH_ON"})},{value:"2",title:this.intlMessage({intlName:"search.SAFESEARCH_MODERATE"})},{value:"3",title:this.intlMessage({intlName:"search.SAFESEARCH_OFF"})}],this.defaultSearch=this.safeSearch[0],this.advancedPanelVisible=n.advancedPanelVisible,this},loadState:function(){var t=this,n,r,i,o=this.appContext.getViewer(),u=this.searchUrl.getAPIParams();this.colors=e.clone(s);if(u.color_codes){i=u.color_codes.split(",");for(n=0;n<this.colors.length;n++)r=this.colors[n],i.indexOf(r.int)!==-1&&(r.selected=!0),i.length===this.maxColors&&!r.selected&&r.int!=="bw"&&(r.disabled=!0);r.code==="bw"&&(this.bwMode=!0)}return o.signedIn?this.appContext.getModel("person-preferences-models",o.nsid).then(function(n){var r=n.toJSON(),i=e.SearchHelper.convertSafeSearchPrefsToApi(r.safeSearch);t.safeSearch.forEach(function(e){e.value===i&&(t.defaultSearch=e)})}):e.Promise.resolve()},buildContainer:function(){var e,t,n,r;return n=this.searchUrl.getAPIParams(),r=this.getDateParams(n),e={apiParams:n,licenses:this.licenses,safeSearch:this.safeSearch,colors:this.colors,orientation:this.getOrientationParams(n),sizes:this.getSizeParams(n),tagMode:this.getTagModeParams(n),selectedLicense:this.getLicenseParams(n),selectedSearch:this.getSafeSearchParams(n),startDate:r.startLabel?r[r.startLabel]:!1,endDate:r.endLabel?r[r.endLabel]:!1,globalNavRestyleFlipped:this.appContext.flipper.isFlipped("global-nav-restyle"),dateParams:r,media:this.getMediaParams(n),resetUrl:this.getAdvancedSearchResetUrl(n)},t=this.templates("search-advanced-panel")(e),this.setContainerHTML(t),this.advancedPanelVisible||this.get("container").addClass("collapsed"),this},activate:function(){var t=this.get("container").one("form"),n=this;return this.datePickers={},e.use("pikaday",function(e){n.datePickers.start=new e.Pikaday({i18n:n.dateIntl,position:"bottom",field:n.get("container").one(".datetime").getDOMNode(),format:n.intlMessage({intlName:"pikaday.DATE_FORMAT"})}),n.datePickers.end=new e.Pikaday({i18n:n.dateIntl,position:"bottom",field:n.get("container").one(".datetime[name=dateto]").getDOMNode(),format:n.intlMessage({intlName:"pikaday.DATE_FORMAT"})})}),this.registerEventHandler(this.get("container").one(".safesearch").on("click",this.safeSearchOptionClicked.bind(this))),this.registerEventHandler(this.get("container").one(".search-license").on("click",this.licenseOptionClicked.bind(this))),this.registerEventHandler(t.on("change"
,this.onFormChange.bind(this))),this},onParentViewEvent:function(e,t){var n=this.get("container");t&&t[0]==="collapse-advanced"?(this.searchUrl.removeAPIParam("advanced"),n.addClass("collapsed"),this.advancedPanelVisible=!1):t&&t[0]==="open-advanced"&&(n.removeClass("collapsed"),this.advancedPanelVisible=!0)},handleDroparoundOptionClick:function(e,n,r){var i=n[e.menuItemIndex];i.value===t?this.searchUrl.removeAPIParam(r):(this.searchUrl.setAPIParam(r,i.value),this.searchUrl.setAPIParam("advanced",1)),this.scheduleSearchUpdate()},safeSearchOptionClicked:function(t){t.preventDefault();var n=this,r=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,padding:0,anchorElement:this.get("container").one(".safesearch"),menuItems:this.getMenuItems(this.safeSearch)});r.show(),this.registerEventHandler(r.on("selected",function(e){n.handleDroparoundOptionClick.call(n,e,n.safeSearch,"safe_search"),r.close()}),this)},licenseOptionClicked:function(t){t.preventDefault();var n=this,r=new e.Views.FluidDroparound({appContext:this.appContext,dismissOnOverlayClick:!0,showDropArrow:!0,padding:0,anchorElement:this.get("container").one(".search-license"),menuItems:this.getMenuItems(this.licenses)});r.show(),this.registerEventHandler(r.on("selected",function(t){n.searchUrl.removeAPIParam(e.SearchHelper.API.license),n.searchUrl.removeAPIParam(e.SearchHelper.API.commons),n.handleDroparoundOptionClick.call(n,t,n.licenses,"license"),r.close()}),this)},onFormChange:function(t){var i=this.get("container"),s=i.one("form"),o,u,a,f,l,c,h=0,p=!1,d=!1,v,m,g=!1,y=!1,b=s.all(".content-type"),w,E,S=this;t.target.hasClass("orientation")&&(this.searchUrl.removeAPIParam(e.SearchHelper.API.orientation),o=s.all("input.orientation").getDOMNodes(),u=o.filter(function(e){return e.checked}).map(function(e){return e.id}),u.length!==o.length&&this.searchUrl.setAPIParam(e.SearchHelper.API.orientation,u.join(",")),u.length===1?s.one("#"+u[0]).setAttribute("disabled",!0):o.forEach(function(e){e.removeAttribute("disabled")})),t.target.hasClass("sizes")&&(a=s.all("input.sizes").getDOMNodes(),a.some(function(t){if(t.checked)switch(t.id){case"photo-size-medium":l=n;break;case"photo-size-large":l=r;break;default:}if(l)return f="min",S.searchUrl.setAPIParam(e.SearchHelper.API.height,l).setAPIParam(e.SearchHelper.API.width,l).setAPIParam(e.SearchHelper.API.dimensionSearchMode,f),!0;S.searchUrl.removeAPIParam(e.SearchHelper.API.height).removeAPIParam(e.SearchHelper.API.width).removeAPIParam(e.SearchHelper.API.dimensionSearchMode)})),c=s.all("input.color"),t.target.hasClass("color")&&(p=!0,window.Y=e,d=t.target.get("value")==="bw"&&e.one("#color-bw").get("checked"),h=c.filter(function(t){return e.one(t).get("checked")}).size(),d?(this.uncheckColors(c),this.setColorDisabledState(c,!1)):(e.one("#color-bw").set("checked",!1),this.setColorDisabledState(c,h===S.maxColors)),c.each(function(e){e.get("checked")?S.searchUrl.addColorCode(e.get("value")):S.searchUrl.removeColorCode(e.get("value"))}));if(t.target.ancestor(".section-date")){if(!this.datePickers||!this.datePickers.start||!this.datePickers.end)return;v=this.datePickers.start.toString("MM-DD-YYYY"),m=this.datePickers.end.toString("MM-DD-YYYY"),s.one("#uploaded").get("checked")?this.dateMode=s.one("#uploaded").get("value"):s.one("#taken").get("checked")&&(this.dateMode=s.one("#taken").get("value"));if(!v&&!m)return;this.searchUrl.removeAPIParam(e.SearchHelper.API.minTakenDate).removeAPIParam(e.SearchHelper.API.maxTakenDate).removeAPIParam(e.SearchHelper.API.minUploadDate).removeAPIParam(e.SearchHelper.API.maxUploadDate),v.match(/\d{2}\-\d{1,2}-\d{4}/)?this.searchUrl.setAPIParam("min_"+this.dateMode,e.moment(v,"MM-DD-YYYY").format("X")):s.one("[name=datefrom]").set("value",""),m.match(/\d{2}\-\d{1,2}-\d{4}/)&&this.searchUrl.setAPIParam("max_"+this.dateMode,e.moment(m,"MM-DD-YYYY").format("X"))}t.target.hasClass("content-type")&&(w=b.filter(function(t){return e.one(t).get("checked")}),w.size()===1?w.set("disabled",!0):b.set("disabled",!1),b.each(function(e){var t=e.get("name"),n=e.get("checked");t==="photos"&&n&&(y=!0),t==="videos"&&n&&(g=!0)}),this.searchUrl.setMedia(y,g)),E=this.searchUrl.getSearchTerm(),i.one("#full-text").get("checked")&&E?(this.searchUrl.setAPIParam(e.SearchHelper.API.text,E),this.searchUrl.removeAPIParam(e.SearchHelper.API.tags),this.searchUrl.removeAPIParam(e.SearchHelper.API.tagMode)):i.one("#tags-only").get("checked")&&(E&&this.searchUrl.setAPIParam(e.SearchHelper.API.tags,E),this.searchUrl.removeAPIParam(e.SearchHelper.API.text),this.searchUrl.setAPIParam(e.SearchHelper.API.tagMode,"any")),this.searchUrl.setAPIParam("advanced",1),this.scheduleSearchUpdate()},setColorDisabledState:function(e,t){e.each(function(e){e.get("value")!=="bw"&&!e.get("checked")&&e.set("disabled",t)})},uncheckColors:function(e){e.each(function(e){e.get("value")!=="bw"&&(e.set("checked",!1),e.set("disabled",!1))})},scheduleSearchUpdate:function(){this.appContext.flapp.navigate(this.searchUrl.getURL()),this.fire("subviewViewEvent","dirty")},getTagModeParams:function(t){var n={};return t=t||{},t[e.SearchHelper.API.tags]||t[e.SearchHelper.API.tagMode]?(n.text=!1,n.tags=!0):(n.text=!0,n.tags=!1),n},getLicenseParams:function(t){var n=!1,r;return t=t||{},t[e.SearchHelper.API.license]?(r=e.SearchHelper.deriveCCLicenseString(t),r?n={value:"",title:this.intlMessage(r)}:this.licenses.some(function(r){if(r.value===t[e.SearchHelper.API.license]+"")return n=r,!0})):t[e.SearchHelper.API.commons]&&(n=this.licenses[i]),n=n||this.defaultLicense,n},getSafeSearchParams:function(t){var n=!1;return t=t||{},t[e.SearchHelper.API.safeSearch]&&this.safeSearch.forEach(function(r){r.value===t[e.SearchHelper.API.safeSearch]&&(n=r)}),n=n||this.defaultSearch,n},getOrientationParams:function(t){var n={},r;t=t||{};if(t[e.SearchHelper.API.orientation])t[e.SearchHelper.API.orientation].split(",").forEach(function(e,t,r){n[e]={checked:!0,disabled:r.length===1}});else for(r in e.SearchHelper.API_ORIENTATION_OPTIONS
)n[e.SearchHelper.API_ORIENTATION_OPTIONS[r]]={checked:!0,disabled:!1};return n},getMediaParams:function(t){var n,r;return t=t||{},r=t[e.SearchHelper.API.mediaType]==="all"||!t[e.SearchHelper.API.mediaType],n={photos:{checked:r||t[e.SearchHelper.API.mediaType]==="photos",disabled:!r&&t[e.SearchHelper.API.mediaType]==="photos"},videos:{checked:r||t[e.SearchHelper.API.mediaType]==="videos",disabled:!r&&t[e.SearchHelper.API.mediaType]==="videos"}},n},getSizeParams:function(t){var i;return t=t||{},i={width:t[e.SearchHelper.API.width],height:t[e.SearchHelper.API.height],mode:t[e.SearchHelper.API.dimensionSearchMode]},i.mode==="min"&&(i.height===n&&i.width===n?i.medium=!0:i.height===r&&i.width===r&&(i.large=!0)),!i.medium&&!i.large&&(i.height||i.width?i.custom=!0:i.all=!0),i},getDateParams:function(t){var n;return t=t||{},n={uploaded:!1,taken:!0},t[e.SearchHelper.API.minUploadDate]?(n.uploaded=!0,n.taken=!1,n.startLabel=e.SearchHelper.API.minUploadDate):t[e.SearchHelper.API.minTakenDate]&&(n.uploaded=!1,n.taken=!0,n.startLabel=e.SearchHelper.API.minTakenDate),t[e.SearchHelper.API.maxUploadDate]?(n.uploaded=!0,n.taken=!1,n.endLabel=e.SearchHelper.API.maxUploadDate):t[e.SearchHelper.API.maxTakenDate]&&(n.uploaded=!1,n.taken=!0,n.endLabel=e.SearchHelper.API.maxTakenDate),n.startLabel&&(n[n.startLabel]=e.moment.unix(parseInt(t[n.startLabel],10)).format(this.intlMessage({intlName:"pikaday.DATE_FORMAT"}))),n.endLabel&&(n[n.endLabel]=e.moment.unix(parseInt(t[n.endLabel],10)).format(this.intlMessage({intlName:"pikaday.DATE_FORMAT"}))),n},getMenuItems:function(e){var t=[],n=0;for(n=0;n<e.length;n++)t.push({text:e[n].title});return t},getAdvancedSearchResetUrl:function(t){var n,r;return this.advancedSearchParamsAreDefaults(t)?"":(t=e.merge(t||{}),r=this.searchUrl.getSearchTerm(),e.SearchHelper.clearParamsExceptSearchScope(t),delete t[e.SearchHelper.API.commons],r&&(t[e.SearchHelper.API.text]=r),n=new e.SearchUrl(t,this.appContext),n.setAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.advanced,1),n.getURL())},advancedSearchParamsAreDefaults:function(t){var n=this.getTagModeParams(t),r=this.getTagModeParams(),i=this.getLicenseParams(t),s=this.getLicenseParams(),o=this.getSafeSearchParams(t),u=this.getSafeSearchParams(),a=this.getOrientationParams(t),f=this.getOrientationParams(),l=this.getMediaParams(t),c=this.getMediaParams(),h=this.getSizeParams(t),p=this.getSizeParams(),d=this.getDateParams(t),v=this.getDateParams(),m=!0;return m=this.colors.every(function(e){return!e.selected}),m&&e.SearchHelper.objectsAreEquivalentToDepth(n,r,1)&&e.SearchHelper.objectsAreEquivalentToDepth(i,s,1)&&e.SearchHelper.objectsAreEquivalentToDepth(o,u,1)&&e.SearchHelper.objectsAreEquivalentToDepth(a,f,2)&&e.SearchHelper.objectsAreEquivalentToDepth(l,c,2)&&e.SearchHelper.objectsAreEquivalentToDepth(h,p,1)&&e.SearchHelper.objectsAreEquivalentToDepth(d,v,1)}},{ATTRS:{}})},"@VERSION@",{requires:["flickr-view","flickr-promise","hermes-template-search-advanced-panel","search-advanced-panel-css","search-helper","search-url","flickrui-css","pikaday-css","flickrui-dialogs-css","dropdown","moment"],optionalRequires:["pikaday"],langBundles:["search","pikaday","common"]});
YUI.add("hermes-template-search-photos-everyone-view",function(e,t){var n=e.Template.Handlebars.revive(function(e,t,n,r,i){function c(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.viewAll,{hash:{},inverse:f.program(7,v,t),fn:f.program(2,h,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function h(e,t){var r="",i;r+='\n		<div>\n			<h5 class="search-results-header">',i=n.unless.call(e,e.loading,{hash:{},inverse:f.noop,fn:f.program(3,p,t),data:t});if(i||i===0)r+=i;(i=n.photoListTitle)?i=i.call(e,{hash:{},data:t}):(i=e.photoListTitle,i=typeof i===l?i.apply(e):i),r+=a(i),i=n["if"].call(e,e.loading,{hash:{},inverse:f.noop,fn:f.program(5,d,t),data:t});if(i||i===0)r+=i;return r+="</h5>\n		</div>\n	",r}function p(e,t){var r="",i,s;return r+='<span class="secondary">',s={hash:{intlName:"search.RESULTS_COUNT",count:e.photoCount},data:t},r+=a((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):u.call(e,"intlHTMLMessage",s)))+"</span>",r}function d(e,t){return' <div class="flickr-dots inline"></div>'}function v(e,t){var r="",i;r+='\n		<div>\n			<h5 class="search-results-header">',i=n.unless.call(e,e.loading,{hash:{},inverse:f.noop,fn:f.program(8,m,t),data:t});if(i||i===0)r+=i;(i=n.photoListTitle)?i=i.call(e,{hash:{},data:t}):(i=e.photoListTitle,i=typeof i===l?i.apply(e):i),r+=a(i),i=n["if"].call(e,e.loading,{hash:{},inverse:f.noop,fn:f.program(5,d,t),data:t});if(i||i===0)r+=i;return r+="</h5>\n		</div>\n	",r}function m(e,t){var r;return r=n.unless.call(e,e.singleResult,{hash:{},inverse:f.noop,fn:f.program(9,g,t),data:t}),r||r===0?r:""}function g(e,t){var r="",i,s;return r+='<a href="',(i=n.viewAllLink)?i=i.call(e,{hash:{},data:t}):(i=e.viewAllLink,i=typeof i===l?i.apply(e):i),r+=a(i)+'" class="view-more-link">',s={hash:{intlName:"search.VIEW_ALL_COUNT",count:e.photoCount},data:t},r+=a((i=n.intlHTMLMessage||e.intlHTMLMessage,i?i.call(e,s):u.call(e,"intlHTMLMessage",s)))+"</a>",r}function y(e,t){var r="",i;r+="\n	",i=n["if"].call(e,e.validResults,{hash:{},inverse:f.noop,fn:f.program(12,b,t),data:t});if(i||i===0)r+=i;return r+="\n",r}function b(e,t){var r="",i,s;return r+="\n		",s={hash:{},data:t},r+=a((i=n.outlet||e.outlet,i?i.call(e,e["photo-list-view"],s):u.call(e,"outlet",e["photo-list-view"],s)))+"\n	",r}this.compilerInfo=[4,">= 1.0.0"],n=this.merge(n,e.helpers),i=i||{};var s="",o,u=n.helperMissing,a=this.escapeExpression,f=this,l="function";o=n["if"].call(t,t.validResults,{hash:{},inverse:f.noop,fn:f.program(1,c,i),data:i});if(o||o===0)s+=o;s+="\n",o=n.unless.call(t,t.loading,{hash:{},inverse:f.noop,fn:f.program(11,y,i),data:i});if(o||o===0)s+=o;return s+="\n",s}),r={};e.Array.each([],function(t){var n=e.Template.get("hermes/"+t);n&&(r[t]=n)}),e.Template.register("hermes/search-photos-everyone-view",function(t,i){return i=i||{},i.partials=i.partials?e.merge(r,i.partials):r,n(t,i)})},"@VERSION@",{requires:["template-base","handlebars-base"]});
YUI.add("search-photos-everyone-view",function(e){var t={"photo-models":{name:"photo-list-photo-view",params:{excludePeople:!0}},"photo-lite-models":{name:"photo-list-photo-view",params:{excludePeople:!0}}},n={jst:{rowHeight:170,subviewMapping:t},thm:{rowHeight:120,forceAspectRatio:1,subviewMapping:t},til:{rowHeight:210,forceAspectRatio:1,loadMoreMargin:5,subviewMapping:{"photo-models":{name:"photo-list-tile-view",params:{excludePeople:!0}},"photo-lite-models":{name:"photo-list-tile-view",params:{excludePeople:!0}}}}};e.namespace("Views")[this.name]=e.Base.create(this.name,e.FlickrView,[],{langBundles:this.details.langBundles,initializer:function(t){var r,i=t.modelParams?t.modelParams.apiParams:{},s,o,u;this.get("container").get("innerHTML")===""&&(r=this.templates("search-photos-everyone-view")({loading:!0}),this.setContainerHTML(r)),t.viewType||(t.viewType="jst"),s=n[t.viewType].forceAspectRatio,o=n[t.viewType].loadMoreMargin,u=e.clone(n[t.viewType].subviewMapping),this.searchUrl=new e.SearchUrl(i,this.appContext,e.SearchUrl.searchTypes.PHOTOS),this.searchTerm=t.searchTerm,this.apiFailed=t.apiFailed;if(this.apiFailed)return this;i[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll]?(this.viewAll=!0,this.searchUrl.removeAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll),this.searchUrl.removeAPIParam(e.SearchHelper.API.userId),this.searchUrl.removeAPIParam(e.SearchHelper.API.contacts),this.viewAllLink=!1):(this.searchUrl.setAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll,!0),this.viewAllLink=this.searchUrl.getURL()),this.searchId=t.searchId,t.photoListConfig={modelParams:{registryName:"search-photos-lite-models",modelIdOrAttributes:t.searchId,collectionAttributeName:"photos",fetchParams:{apiParams:i}},pageParams:{page:1,perPage:50,perPageDoubling:1},parentName:this.name,loadMoreMargin:3,engagementModelName:"photo-lite-models",injectPhotolistContextParams:{rapidBeaconConfig:{beaconName:"searchPhotoResultClick",itemIndexKey:"vespaRnk"}},measureAFT:!0,scrollInterruptParams:{pageCounts:[5],footerToHideWhileScrolling:".footer-full-view"},layout:{containerPadding:{top:0,right:0,bottom:8,left:0},targetRowHeight:n[t.viewType].rowHeight,awakeBoundsToViewportSizeRatio:5}},s&&(t.photoListConfig.layout.forceAspectRatio=s),o&&(t.photoListConfig.layout.loadMoreMargin=o);if(u){t.photoListConfig.subviewMapping=u;if(!this.appContext.flipper.isFlipped("search-exclude-people"))for(var a in u)t.photoListConfig.subviewMapping[a].params.excludePeople=!1}return this.appContext.flipper.isFlipped("global-nav-restyle")&&t.viewType===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified&&(t.photoListConfig.layout.itemSpacing={horizontal:4,vertical:4}),this},subviewConfig:{"photo-list-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return this.apiFailed}}},loadState:function(){var t=this;return this.apiFailed?e.Promise.resolve():this.appContext.getModel("search-photos-lite-models",this.searchId).then(function(n){return t.searchModel=n,t.apiParams=t.searchModel.getValue("apiParams"),e.SearchHelper.deriveScopeTitle(t.apiParams,t.appContext)}).then(function(e){t.scopeTitle=t.intlMessage(e)})},buildContainer:function(){var e=this.templates("search-photos-everyone-view")({validResults:this.searchModel&&this.searchModel.getValue("totalItems")>0,photoListTitle:this.scopeTitle,viewAllLink:this.viewAllLink,photos:this.apiFailed?"":this.searchModel.toJSON(),photoCount:this.apiFailed?"":this.searchModel.getValue("totalItems"),singleResult:this.apiFailed?!1:this.searchModel.getValue("totalItems")===1,"photo-list-view":this.apiFailed?"":this.subviews["photo-list-view"].get("container"),viewAll:this.viewAll});return this.setContainerHTML(e),this},buildHeadContainer:function(){this.subviews["photo-list-view"]&&this.set("headContainer",this.subviews["photo-list-view"].get("headContainer"))},activate:function(){return this}})},"@VERSION@",{requires:["flickr-view","photo-list-view","flickr-promise","search-url","hermes-template-search-photos-everyone-view","search-helper","flutil","search-photos-lite-models","person-preferences-models"],langBundles:["search"]});
YUI.add("search-counts-models",function(e){function t(e){t.superclass.constructor.call(this,e)}function n(t){return t=e.AttributeHelpers.coerceInteger(t),t}e.Models[this.name]=t,e.extend(t,e.FlickrModelRegistry,{name:this.name,remote:{read:function(t){return e.ModelFetchers["flickr-search-counts"].run(t,this.appContext)}},attributes:{everyonePhotos:{setter:n,defaultValue:0},youPhotos:{setter:n,defaultValue:0},sets:{setter:n,defaultValue:0},yourGroups:{setter:n,defaultValue:0},groups:{setter:n,defaultValue:0},contactsPhotos:{setter:n,defaultValue:0},people:{setter:n,defaultValue:0},peopleFollowed:{setter:n,defaultValue:0},apiParams:{writeOnce:"initOnly"},emptyQuery:{defaultValue:!1}}})},"@VERSION@",{requires:["flickr-model-registry","flickr-search-counts-fetcher","search-helper"]});
YUI.add("flickr-search-counts-fetcher",function(e,t){"use strict";function n(t){var n={id:t.id,emptyQuery:!1},r=e.merge(t.apiParams);return r.username&&(r.text=r.username),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(r),e.SearchHelper.isParameterlessSearch(r)?(n.emptyQuery=!0,n):(r.counts_only=1,n.everyonePhotos=e.merge(r),n.everyonePhotos.faves?n.everyonePhotos.user_id||(n.everyonePhotos.user_id=t.viewerNsid):delete n.everyonePhotos.user_id,delete n.everyonePhotos.contacts,t.viewerNsid&&!r.faves&&(n.contactsPhotos=e.merge(r),delete n.contactsPhotos.user_id,delete n.contactsPhotos.contacts,n.contactsPhotos.contacts="all"),t.viewerNsid&&!r.faves&&(n.youPhotos=e.merge(r),!r.user_id&&t.viewerNsid&&(n.youPhotos.user_id=t.viewerNsid)),t.viewerNsid&&!r.faves&&r.text&&(n.sets={counts_only:1,text:r.text,user_id:t.viewerNsid},r.sort&&(n.sets.sort=r.sort)),r.text&&(n.groups={counts_only:1,text:r.text},r.sort&&(n.groups.sort=r.sort),r[e.SearchHelper.GROUPS_SEARCH_API.filterInactive]&&(n.groups[e.SearchHelper.GROUPS_SEARCH_API.filterInactive]=r[e.SearchHelper.GROUPS_SEARCH_API.filterInactive]),t.viewerNsid&&(n.yourGroups={counts_only:1,text:r.text},n.yourGroups.user_id=t.viewerNsid,r.sort&&(n.yourGroups.sort=r.sort),r[e.SearchHelper.GROUPS_SEARCH_API.filterInactive]&&(n.yourGroups[e.SearchHelper.GROUPS_SEARCH_API.filterInactive]=r[e.SearchHelper.GROUPS_SEARCH_API.filterInactive])),n.people={counts_only:1,username:r.text},r.sort&&(n.people.sort=r.sort),t.viewerNsid&&(n.peopleFollowed={counts_only:1,username:r.text},n.peopleFollowed.user_id=t.viewerNsid,r.sort&&(n.peopleFollowed.sort=r.sort))),n)}function r(t,n){var r={id:n.id||e.SearchUrl.EMPTY_SEARCH_ID,everyonePhotos:0,youPhotos:0,sets:0,yourGroups:0,groups:0,contactsPhotos:0,people:0,peopleFollowed:0,apiParams:{},emptyQuery:n.emptyQuery},i,s,o=t[0],u=t[1];n.id&&n.id!==e.SearchUrl.EMPTY_SEARCH_ID&&(r.apiParams=e.QueryString.parse(n.id));for(i in o)o[i]?o[i].photos?s=parseInt(o[i].photos.count,0):o[i].people?s=parseInt(o[i].people.count,0):o[i].groups?s=parseInt(o[i].groups.count,0):o[i].photosets&&(s=parseInt(o[i].photosets.count,0)):s=0,isNaN(s)?r[i]=0:r[i]=s;return u.exists(n.id)||u.add(r),o}function i(t,n){var r=n.length,i={};return new e.Promise(function(e,s){for(var o=0;o<n.length;o++)t.callAPI(n[o].method,n[o].data).then(function(){var t=n[o].id;return function(n){r--,i[t]=n,r<=0&&e(i)}}(),function(t){r--,r<=0&&e(i)})})}function s(n,r){var s=this,o=r.getViewer(),u=[];return n=n.emptyQuery?{}:this._processParams(e.merge({viewerNsid:o.signedIn?o.nsid:null,parse_tags:"1"},n)),n.emptyQuery||(n.everyonePhotos&&u.push({method:"flickr.photos.search",data:n.everyonePhotos,id:"everyonePhotos"}),n.youPhotos&&u.push({method:"flickr.photos.search",data:n.youPhotos,id:"youPhotos"}),n.sets&&u.push({method:"flickr.photosets.search",data:n.sets,id:"sets"}),n.yourGroups&&u.push({method:"flickr.groups.search",data:n.yourGroups,id:"yourGroups"}),n.groups&&u.push({method:"flickr.groups.search",data:n.groups,id:"groups"}),n.contactsPhotos&&u.push({method:"flickr.photos.search",data:n.contactsPhotos,id:"contactsPhotos"}),n.people&&u.push({method:"flickr.people.search",data:n.people,id:"people"}),n.peopleFollowed&&u.push({method:"flickr.people.search",data:n.peopleFollowed,id:"peopleFollowed"})),e.Promise.all([n.emptyQuery?e.Promise.resolve({}):i(r,u),r.getModelRegistry("search-counts-models")]).then(function(e){return s._processResponse(e,n)},e.FetcherErrorLogger(t))}e.namespace("ModelFetchers")["flickr-search-counts"]={run:s,_processResponse:r,_processParams:n}},"@VERSION@",{requires:["flickr-promise","search-helper","search-url","querystring-parse-simple"],optional:["search-counts-models"]});
YUI.add("search-photos-unified-page-view",function(e){var t=e.url("/help/forum/en-us/72157651248603362/lastpage#reply"),n="reboot-unified-search",r=[{name:"unifiedgroupssearchpage_opt",value:0},{name:"unifiedpeoplesearchpage_opt",value:0},{name:"advsearchpage_opt",value:0}],i=244,s=34;e.namespace("Views")[this.name]=e.Base.create("search-photos-unified-page-view",e.FlickrView,[],{langBundles:this.details.langBundles,advancedPanelVisible:!1,initializer:function(t){var r,i=this.appContext.getViewer();this.apiParams=t.modelParams?t.modelParams.apiParams:{},this.searchUrl=new e.SearchUrl(this.apiParams,this.appContext),this.searchTerm=t.searchTerm,t.optOutLabelText=this.intlMessage({intlName:"search.SEARCH_BETA_LABEL"}),t.optOutFeedbackLinkHoverText=this.intlMessage({intlName:"search.PROVIDE_FEEDBACK"}),t.optOutButtonHoverText=this.intlMessage({intlName:"search.GO_BACK_TO_OLD_SEARCH"}),t.optOutCookieField=n,this.showYours=i.signedIn,this.showContacts=i.signedIn,this.showAlbums=i.signedIn,this.showEveryones=!0,this.showEmpty=!1,this.apiFailed=t.apiFailed;if(this.apiFailed)return this.showYours=!1,this.showContacts=!1,this.showAlbums=!1,this.showEveryones=!1,this.showEmpty=!0,this;this.searchId=t.searchId,this.advancedPanelVisible=this.checkParamsForAdvancedPanel(),t.advancedPanelVisible=this.advancedPanelVisible,r=this.name.replace(/-/g,"_"),YUI.Env.isServer&&e.config.flickr.paft_metrics_samples&&e.config.flickr.paft_metrics_samples[r]&&(t.paft=!0);if(this.apiParams[e.SearchHelper.API.userId]||this.apiParams[e.SearchHelper.API.groupId]||this.apiParams[e.SearchHelper.API.contacts]||this.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll])this.showContacts=!1,this.showAlbums=!1,this.showYours=!1;return this.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.albums]?this.showAlbums=!0:!this.apiParams[e.SearchHelper.API.text]&&!this.apiParams[e.SearchHelper.API.userId]&&(this.showAlbums=!1),this.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll]||this.searchUrl.removeAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll),this.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll]&&this.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.albums]?this.showEveryones=!1:this.searchUrl.removeAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.albums),this.apiParams[e.SearchHelper.API.faves]&&(this.showContacts=!1,this.showAlbums=!1,this.showYours=!1),YUI.Env.isServer||this.appContext.clientMetrics.setPendingMeasurement(this.name,!0),t.sortMenuItems=this.buildSortMenuItems(t.modelParams.apiParams),this},subviewConfig:{"global-nav-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,isSearchResults:!0},"search-subnav-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,selectedTabKey:"photos",disabled:function(){return this.apiFailed}},"opt-out-widget-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,optOutFeedbackUrl:t,optOutFlippers:r,hidden:!0},"search-empty-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0},"search-photos-yours-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.showYours}},"search-photos-contacts-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.showContacts}},"search-photos-albums-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.showAlbums}},"search-advanced-panel-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0,disabled:function(){return this.apiFailed}},"search-photos-everyone-view":{requiredToShowOnClient:!0,requiredToShowOnServer:!0,disabled:function(){return!this.showEveryones}},"footer-full-view":{requiredToShowOnClient:!1,requiredToShowOnServer:!0}},loadState:function(){var t=this;return this.apiFailed?(e.SearchHelper.addParamDefaults(this.apiParams),e.Promise.resolve()):e.FlickrPromise({searchModel:this.appContext.getModel("search-photos-lite-models",this.searchId),countsModel:this.appContext.getModel("search-counts-models",this.searchId)}).then(function(e){var n=e.countsModel,r=n.getValue("youPhotos"),i=n.getValue("sets"),s=n.getValue("contactsPhotos");t.searchModel=e.searchModel,t.countsModel=e.countsModel,r<1&&(t.showYours=!1),i<1&&(t.showAlbums=!1),s<1&&(t.showContacts=!1),t.searchModel.getValue("totalItems")<1&&(t.showEveryones=!1),t.showYours||t.showAlbums||t.showContacts||t.showEveryones||(t.showEmpty=!0,t.searchModel.getValue("emptyQuery")||(t.subviews["search-empty-view"].set("noMatchesForQuery",t.buildNoMatchesFoundMessage()),t.subviews["search-empty-view"].fire("parentViewEvent","error-msg-updated"))),t.apiParams=t.searchModel.getValue("apiParams"),YUI.Env.isServer||t.beaconIfAllAFTResultsComplete("atfVisible")})},buildContainer:function(){var t;return this.searchModel&&this.searchModel.getValue("emptyQuery")&&(this.showYours=!1,this.showContacts=!1,this.showAlbums=!1,this.showEveryones=!1,this.showEmpty=!0),t={"global-nav-view":this.subviews["global-nav-view"].get("container"),"search-advanced-panel":this.apiFailed?"":this.subviews["search-advanced-panel-view"].get("container"),"search-subnav-view":this.apiFailed?"":this.subviews["search-subnav-view"].get("container"),showEmpty:this.showEmpty,showAlbums:this.showAlbums,showEveryones:this.showEveryones,showContacts:this.showContacts,showYours:this.showYours,viewingAll:this.searchUrl.getAPIParam(e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll),"footer-full-view":this.subviews["footer-full-view"]?this.subviews["footer-full-view"].get("container"):"","opt-out-widget-view":this.subviews["opt-out-widget-view"]?this.subviews["opt-out-widget-view"].get("container"):"",advancedPanelVisible:this.advancedPanelVisible,globalNavRestyleFlipped:this.appContext.flipper.isFlipped("global-nav-restyle")},["search-empty-view","search-photos-yours-view","search-photos-albums-view","search-photos-contacts-view","search-photos-everyone-view"].forEach(function(e){this.subviews[e]&&(t[e]=this.subviews[e].get("container"))}.bind(this)),this.setContainerHTML(this.templates("search-photos-unified-page-view"
)(t)),this},buildHeadContainer:function(){var e="",t=this;["search-photos-yours-view","search-photos-albums-view","search-photos-contacts-view","search-photos-everyone-view"].forEach(function(n){t.subviews[n]&&(e+=t.subviews[n].get("headContainer"))}),this.set("headContainer",e)},activate:function(){return this.fire("parentViewEvent","showOptOutWidget"),e.later(100,this,function(){e.use("photo-page-scrappy-view")}),this},buildSortMenuItems:function(t){var n=(new e.SearchUrl(t,this.appContext)).setSearchType(e.SearchUrl.searchTypes.PHOTOS),r=[];return n.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.relevant),r.push({text:this.intlMessage({intlName:"search.RELEVANT"}),href:n.getURL()}),n.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.recent),r.push({text:this.intlMessage({intlName:"search.RECENT"}),href:n.getURL()}),n.setAPIParam("sort",e.SearchHelper.API_SORT_OPTIONS.interesting),r.push({text:this.intlMessage({intlName:"search.INTERESTING"}),href:n.getURL()}),r},buildNoMatchesFoundMessage:function(){var t,n,r,i=this.appContext.getViewer();return n=this.searchModel.getValue("apiParams"),n.user_id?i.signedIn&&n.user_id===i.nsid?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_YOUR":r="search.NO_MATCHES_FOR_QUERY_TERM_YOUR":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_USER":r="search.NO_MATCHES_FOR_QUERY_TERM_USER":n.contacts?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_CONTACTS":r="search.NO_MATCHES_FOR_QUERY_TERM_CONTACTS":n.group_id?this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM_CONTEXT_GROUP":r="search.NO_MATCHES_FOR_QUERY_TERM_GROUP":this.searchTerm?r="search.NO_MATCHES_FOR_QUERY_TERM":r="search.NO_MATCHES_FOR_QUERY",this.searchTerm?t=this.intlMessage({intlName:r,searchTerm:e.flutil.unescape(this.searchTerm)}):t=this.intlMessage({intlName:r}),{noMatchesText:t}},onSubviewEvent:function(e,t){if(!t)return;var n=t[0];switch(n){case"dirty":this.get("container").addClass("dirty");break;case"atfVisible":this.handleAFTResult(e,t);break;case"excludePerson":this.excludePerson(t);break;case"footerDisplayChanged":this.fire("parentViewEvent","footerDisplayChanged");break;default:t[2]&&t[2]==="toggle-advanced"&&this.toggleAdvancedSearch()}},checkParamsForAdvancedPanel:function(){var t=!1;return this.apiParams.advanced?t=!0:this.apiParams[e.SearchHelper.API.license]?t=!0:this.apiParams[e.SearchHelper.API.commons]&&(t=!0),t},toggleAdvancedSearch:function(){this.advancedPanelVisible?this.closeAdvancedPanel():this.openAdvancedPanel()},openAdvancedPanel:function(){var t=this.get("container").one(".advanced-search-wrapper"),n=this.get("container").one("main"),r;r=!this.showEmpty&&e.config.win.pageYOffset>s,r?(n.addClass("advanced-panel-opening"),t.removeClass("collapsed"),this.subviews["search-advanced-panel-view"].fire("parentViewEvent","open-advanced"),this.advancedPanelVisible=!0,e.flutil.onTransitionEnd(t,function(){n.removeClass("advanced-panel-opening"),n.addClass("advanced-panel-visible"),window.scrollBy(0,i)})):(t.removeClass("collapsed"),n.addClass("advanced-panel-visible"),this.subviews["search-advanced-panel-view"].fire("parentViewEvent","open-advanced"),this.advancedPanelVisible=!0)},closeAdvancedPanel:function(){var t=this.get("container").one(".advanced-search-wrapper"),n=this.get("container").one("main"),r,s;r=!this.showEmpty&&e.config.win.pageYOffset>i,r?(n.addClass("advanced-panel-collapsing"),t.addClass("collapsed"),this.subviews["search-advanced-panel-view"].fire("parentViewEvent","collapse-advanced"),this.advancedPanelVisible=!1,s=Math.min(i,e.config.win.document.body.scrollHeight-e.config.win.innerHeight-e.config.win.pageYOffset),e.flutil.onTransitionEnd(t,function(){n.removeClass("advanced-panel-collapsing"),n.removeClass("advanced-panel-visible"),window.scrollBy(0,-s)})):(t.addClass("collapsed"),n.removeClass("advanced-panel-visible"),this.subviews["search-advanced-panel-view"].fire("parentViewEvent","collapse-advanced"),this.advancedPanelVisible=!1)},handleAFTResult:function(e,t){var n=t[0];this.paftResults||(this.paftResults={},this.showYours&&this.subviews["search-photos-yours-view"]&&(this.paftResults["search-photos-yours-view"]={}),this.showContacts&&this.subviews["search-photos-contacts-view"]&&(this.paftResults["search-photos-contacts-view"]={}),this.showEveryones&&this.subviews["search-photos-everyone-view"]&&(this.paftResults["search-photos-everyone-view"]={})),this.paftResults[e]&&(this.paftResults[e][n]=t[1]||(new Date).getTime()),this.beaconIfAllAFTResultsComplete(n)},beaconIfAllAFTResultsComplete:function(t){var n=0,r;if(this.allResultsReceived)return;if(!this.paftResults)return;this.showAlbums||delete this.paftResults["search-photos-albums-view"],this.showYours||delete this.paftResults["search-photos-yours-view"],this.showContacts||delete this.paftResults["search-photos-contacts-view"],this.showEveryones||delete this.paftResults["search-photos-everyone-view"],this.allResultsReceived=Object.keys(this.paftResults).every(function(e){return r=this.paftResults[e][t],typeof r=="undefined"?!1:(r>n&&(n=r),!0)}.bind(this)),this.allResultsReceived&&t==="atfVisible"&&(this.appContext.hasClientSideRouted()?(this.appContext.clientMetrics.mark("AFT_CL",n),this.appContext.clientMetrics.mark("AFT",n)):(e.config.win.performance&&e.config.win.performance.timing&&(n-=e.config.win.performance.timing.navigationStart),this.appContext.clientMetrics.record("AFT_SV",n),this.appContext.clientMetrics.record("AFT",n)),this.appContext.clientMetrics.setPendingMeasurement(this.name,!1),this.appContext.clientMetrics.beacon())},excludePerson:function(t){var n=t&&t[1],r=this.searchUrl.getAPIParam(e.SearchHelper.API.excludeUserId)||"";if(!n)return;r&&(r+=","),r+=n,this.searchUrl.setAPIParam(e.SearchHelper.API.excludeUserId,r),this.appContext.flapp.navigate(this.searchUrl.getURL())}},{ATTRS:{spaceid:{value:792600534}}})},"@VERSION@",{requires:["url","flutil","flickr-view","flickr-promise","search-helper","hermes-template-search-photos-unified-page-view"
,"opt-out-widget-view","search-subnav-view","search-empty-view","search-photos-albums-view","search-photos-yours-view","search-photos-contacts-view","search-advanced-panel-view","search-photos-everyone-view","search-url","search-unified-css","flickrui-css","footer-full-view","querystring-stringify-simple","search-counts-models","search-photos-lite-models"],langBundles:["search"]});
YUI.add("search-photos-route",function(e){function t(e){t.superclass.constructor.call(this,e)}e.Routes[this.name]=t,e.extend(t,e.FlickrRoute,{langBundles:this.details.langBundles,run:function(e){return this.appContext.flipper.isFlipped("reboot-unified-search")?this.runSearchUnified(e):this.runSearchStandard(e)},runSearchUnified:function(t){var n={},r,i=this,s,o,u=!0,a=!0,f,l;return n.apiParams=this.processRequest(t),n.id=e.SearchHelper.generateQueryString(n.apiParams)||e.guid(),s=new e.SearchUrl(n.apiParams,this.appContext,e.SearchUrl.searchTypes.PHOTOS),o=s.getSearchTerm(),o||(u=!1),t.probableUser?n.viewerNsid=t.probableUser:n.viewerNsid=this.appContext.getViewer().nsid,r={perPage:25},l={counts:this.appContext.getModel("search-counts-models",n,r),everyone:this.appContext.getModel("search-photos-lite-models",n,r)},n.viewerNsid&&(l.viewerPrefs=this.appContext.getModel("person-preferences-models",n.viewerNsid)),e.FlickrPromise(l).then(function(t){var r=t.everyone;n.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.albums]&&n.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewAll]&&(a=!1,u=!1);switch(n.apiParams[e.SearchHelper.UNIFIED_SEARCH_PARAMS.viewType]){case"thumbs":f=e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.thumbs;break;case"tiles":f=e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.tiles;break;case"justified":default:f=e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.justified}return!f&&t.viewerPrefs&&(f=t.viewerPrefs.getValue("unifiedSearchViewPref")),i.appContext.flipper.isFlipped("search-tiles")||f===e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPES.tiles&&(f=e.Models["person-preferences-models"].UNIFIED_SEARCH_VIEW_TYPE_DEFAULT),e.Promise.resolve({view:"search-photos-unified-page-view",params:{searchId:YUI.Env.isServer?r.id:r.id,searchType:e.SearchUrl.searchTypes.PHOTOS,searchTerm:o,modelParams:n,showTools:u,showAdvanced:a,showSort:u,viewType:f},layout:"scrolling",fluid:!0})},function(t){return i.appContext.warn("search-photos-route",t.message),e.Promise.resolve({view:"search-photos-unified-page-view",params:{searchTerm:o,apiFailed:!0},fluid:!0})})},runSearchStandard:function(t){var n={},r,i=this,s=i.intlMessage({intlName:"search.FLICKR_SEARCH"}),o=": ",u,a,f=this.appContext.flipper.isFlipped("enable-hover-account-menu")&&this.appContext.flipper.isFlipped("rebootify-group-discussions-list"),l;return n.apiParams=this.processRequest(t),n.id=e.SearchHelper.generateQueryString(n.apiParams)||e.guid(),n.apiParams.text?(u=n.apiParams.text,a=o+n.apiParams.text):n.apiParams.tags&&(a=o+n.apiParams.tags),l=e.flutil.unescape(a),r={perPage:e.SearchHelper.PREFETCH_PAGE_SIZE},this.appContext.getModel("search-photos-models",n,r).then(function(t){return e.Promise.resolve({view:"search-photos-page-view",params:{searchId:YUI.Env.isServer?t.id:t.id,searchType:e.SearchUrl.searchTypes.PHOTOS,searchTerm:u,modelParams:n},title:t.getValue("emptyQuery")||!l?s:s+l,layout:"scrolling",fluid:f})},function(t){return i.appContext.warn("search-photos-route",t.message),e.Promise.resolve({view:"search-photos-page-view",params:{searchTerm:u,apiFailed:!0},title:l?s+l:s,fluid:f})})},processRequest:function(t){var n={};return n=e.merge(t.query,e.SearchHelper.mapRouteParamsToAPI(t.params)),n=e.SearchHelper.mapClassicSearchToAPI(n,this.appContext),t.query[e.SearchHelper.API.tags]&&(n=e.merge(n,e.SearchHelper.processTags(n[e.SearchHelper.API.tags],n[e.SearchHelper.API.tagMode]))),e.SearchHelper.addParamDefaults(n),YUI.Env.isServer&&e.SearchHelper.unescapeParameters(n),n}}),e.mix(t.prototype,e.Localizable)},"@VERSION@",{requires:["flutil","flickr-route","flickr-promise","search-helper","querystring-stringify-simple","localizable","search-photos-models","search-photos-lite-models","url","search-url","search-photos-page-view","search-photos-unified-page-view","person-preferences-models"],langBundles:["search"]});
